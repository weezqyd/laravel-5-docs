

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Database: Getting Started &mdash; Laravel 5 Documentation 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Laravel 5 Documentation 1.0 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Laravel 5 Documentation
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <!-- Local TOC -->
                <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Database: Getting Started</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#read-write-connections">Read / Write Connections</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#running-raw-sql-queries">Running Raw SQL Queries</a><ul>
<li><a class="reference internal" href="#running-a-select-query">Running A Select Query</a></li>
<li><a class="reference internal" href="#using-named-bindings">Using Named Bindings</a></li>
<li><a class="reference internal" href="#running-an-insert-statement">Running An Insert Statement</a></li>
<li><a class="reference internal" href="#running-an-update-statement">Running An Update Statement</a></li>
<li><a class="reference internal" href="#running-a-delete-statement">Running A Delete Statement</a></li>
<li><a class="reference internal" href="#running-a-general-statement">Running A General Statement</a></li>
<li><a class="reference internal" href="#listening-for-query-events">Listening For Query Events</a></li>
</ul>
</li>
<li><a class="reference internal" href="#database-transactions">Database Transactions</a><ul>
<li><a class="reference internal" href="#manually-using-transactions">Manually Using Transactions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-multiple-database-connections">Using Multiple Database Connections</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Laravel 5 Documentation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Database: Getting Started</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/database.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="database-getting-started">
<span id="database-getting-started"></span><h1>Database: Getting Started<a class="headerlink" href="#database-getting-started" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference external" href="#introduction">Introduction</a></li>
<li><a class="reference external" href="#running-queries">Running Raw SQL Queries</a><ul>
<li><a class="reference external" href="#listening-for-query-events">Listening For Query Events</a></li>
</ul>
</li>
<li><a class="reference external" href="#database-transactions">Database Transactions</a></li>
<li><a class="reference external" href="#accessing-connections">Using Multiple Database Connections</a></li>
</ul>
<p><a name="introduction"></a></p>
<div class="section" id="introduction">
<span id="introduction"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Laravel makes connecting with databases and running queries extremely simple across a variety of database back-ends using either raw SQL, the <a class="reference external" href="queries.html">fluent query builder</a>, and the <a class="reference external" href="eloquent.html">Eloquent ORM</a>. Currently, Laravel supports four database systems:</p>
<ul class="simple">
<li>MySQL</li>
<li>Postgres</li>
<li>SQLite</li>
<li>SQL Server</li>
</ul>
<p><a name="configuration"></a></p>
<div class="section" id="configuration">
<span id="configuration"></span><h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h3>
<p>Laravel makes connecting with databases and running queries extremely simple. The database configuration for your application is located at <code class="docutils literal"><span class="pre">config/database.php</span></code>. In this file you may define all of your database connections, as well as specify which connection should be used by default. Examples for all of the supported database systems are provided in this file.</p>
<p>By default, Laravel&#8217;s sample <a class="reference external" href="installation.html#environment-configuration">environment configuration</a> is ready to use with <a class="reference external" href="homestead.html">Laravel Homestead</a>, which is a convenient virtual machine for doing Laravel development on your local machine. Of course, you are free to modify this configuration as needed for your local database.</p>
<p><a name="read-write-connections"></a></p>
<div class="section" id="read-write-connections">
<span id="read-write-connections"></span><h4>Read / Write Connections<a class="headerlink" href="#read-write-connections" title="Permalink to this headline">¶</a></h4>
<p>Sometimes you may wish to use one database connection for SELECT statements, and another for INSERT, UPDATE, and DELETE statements. Laravel makes this a breeze, and the proper connections will always be used whether you are using raw queries, the query builder, or the Eloquent ORM.</p>
<p>To see how read / write connections should be configured, let&#8217;s look at this example:</p>
<pre class="literal-block">
'mysql' =&gt; [
    'read' =&gt; [
        'host' =&gt; '192.168.1.1',
    ],
    'write' =&gt; [
        'host' =&gt; '196.168.1.2'
    ],
    'driver'    =&gt; 'mysql',
    'database'  =&gt; 'database',
    'username'  =&gt; 'root',
    'password'  =&gt; '',
    'charset'   =&gt; 'utf8',
    'collation' =&gt; 'utf8_unicode_ci',
    'prefix'    =&gt; '',
],
</pre>
<p>Note that two keys have been added to the configuration array: <code class="docutils literal"><span class="pre">read</span></code> and <code class="docutils literal"><span class="pre">write</span></code>. Both of these keys have array values containing a single key: <code class="docutils literal"><span class="pre">host</span></code>. The rest of the database options for the <code class="docutils literal"><span class="pre">read</span></code> and <code class="docutils literal"><span class="pre">write</span></code> connections will be merged from the main <code class="docutils literal"><span class="pre">mysql</span></code> array.</p>
<p>So, we only need to place items in the <code class="docutils literal"><span class="pre">read</span></code> and <code class="docutils literal"><span class="pre">write</span></code> arrays if we wish to override the values in the main array. So, in this case, <code class="docutils literal"><span class="pre">192.168.1.1</span></code> will be used as the &#8220;read&#8221; connection, while <code class="docutils literal"><span class="pre">192.168.1.2</span></code> will be used as the &#8220;write&#8221; connection. The database credentials, prefix, character set, and all other options in the main <code class="docutils literal"><span class="pre">mysql</span></code> array will be shared across both connections.</p>
<p><a name="running-queries"></a></p>
</div>
</div>
</div>
<div class="section" id="running-raw-sql-queries">
<span id="running-raw-sql-queries"></span><h2>Running Raw SQL Queries<a class="headerlink" href="#running-raw-sql-queries" title="Permalink to this headline">¶</a></h2>
<p>Once you have configured your database connection, you may run queries using the <code class="docutils literal"><span class="pre">DB</span></code> facade. The <code class="docutils literal"><span class="pre">DB</span></code> facade provides methods for each type of query: <code class="docutils literal"><span class="pre">select</span></code>, <code class="docutils literal"><span class="pre">update</span></code>, <code class="docutils literal"><span class="pre">insert</span></code>, <code class="docutils literal"><span class="pre">delete</span></code>, and <code class="docutils literal"><span class="pre">statement</span></code>.</p>
<div class="section" id="running-a-select-query">
<span id="running-a-select-query"></span><h3>Running A Select Query<a class="headerlink" href="#running-a-select-query" title="Permalink to this headline">¶</a></h3>
<p>To run a basic query, we can use the <code class="docutils literal"><span class="pre">select</span></code> method on the <code class="docutils literal"><span class="pre">DB</span></code> facade:</p>
<pre class="literal-block">
&lt;?php

namespace App\Http\Controllers;

use DB;
use App\Http\Controllers\Controller;

class UserController extends Controller
{
    /**
     * Show a list of all of the application's users.
     *
     * &#64;return Response
     */
    public function index()
    {
        $users = DB::select('select * from users where active = ?', [1]);

        return view('user.index', ['users' =&gt; $users]);
    }
}
</pre>
<p>The first argument passed to the <code class="docutils literal"><span class="pre">select</span></code> method is the raw SQL query, while the second argument is any parameter bindings that need to be bound to the query. Typically, these are the values of the <code class="docutils literal"><span class="pre">where</span></code> clause constraints. Parameter binding provides protection against SQL injection.</p>
<p>The <code class="docutils literal"><span class="pre">select</span></code> method will always return an <code class="docutils literal"><span class="pre">array</span></code> of results. Each result within the array will be a PHP <code class="docutils literal"><span class="pre">StdClass</span></code> object, allowing you to access the values of the results:</p>
<pre class="literal-block">
foreach ($users as $user) {
    echo $user-&gt;name;
}
</pre>
</div>
<div class="section" id="using-named-bindings">
<span id="using-named-bindings"></span><h3>Using Named Bindings<a class="headerlink" href="#using-named-bindings" title="Permalink to this headline">¶</a></h3>
<p>Instead of using <code class="docutils literal"><span class="pre">?</span></code> to represent your parameter bindings, you may execute a query using named bindings:</p>
<pre class="literal-block">
$results = DB::select('select * from users where id = :id', ['id' =&gt; 1]);
</pre>
</div>
<div class="section" id="running-an-insert-statement">
<span id="running-an-insert-statement"></span><h3>Running An Insert Statement<a class="headerlink" href="#running-an-insert-statement" title="Permalink to this headline">¶</a></h3>
<p>To execute an <code class="docutils literal"><span class="pre">insert</span></code> statement, you may use the <code class="docutils literal"><span class="pre">insert</span></code> method on the <code class="docutils literal"><span class="pre">DB</span></code> facade. Like <code class="docutils literal"><span class="pre">select</span></code>, this method takes the raw SQL query as its first argument, and bindings as the second argument:</p>
<pre class="literal-block">
DB::insert('insert into users (id, name) values (?, ?)', [1, 'Dayle']);
</pre>
</div>
<div class="section" id="running-an-update-statement">
<span id="running-an-update-statement"></span><h3>Running An Update Statement<a class="headerlink" href="#running-an-update-statement" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">update</span></code> method should be used to update existing records in the database. The number of rows affected by the statement will be returned by the method:</p>
<pre class="literal-block">
$affected = DB::update('update users set votes = 100 where name = ?', ['John']);
</pre>
</div>
<div class="section" id="running-a-delete-statement">
<span id="running-a-delete-statement"></span><h3>Running A Delete Statement<a class="headerlink" href="#running-a-delete-statement" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">delete</span></code> method should be used to delete records from the database. Like <code class="docutils literal"><span class="pre">update</span></code>, the number of rows deleted will be returned:</p>
<pre class="literal-block">
$deleted = DB::delete('delete from users');
</pre>
</div>
<div class="section" id="running-a-general-statement">
<span id="running-a-general-statement"></span><h3>Running A General Statement<a class="headerlink" href="#running-a-general-statement" title="Permalink to this headline">¶</a></h3>
<p>Some database statements should not return any value. For these types of operations, you may use the <code class="docutils literal"><span class="pre">statement</span></code> method on the <code class="docutils literal"><span class="pre">DB</span></code> facade:</p>
<pre class="literal-block">
DB::statement('drop table users');
</pre>
<p><a name="listening-for-query-events"></a></p>
</div>
<div class="section" id="listening-for-query-events">
<span id="listening-for-query-events"></span><h3>Listening For Query Events<a class="headerlink" href="#listening-for-query-events" title="Permalink to this headline">¶</a></h3>
<p>If you would like to receive each SQL query executed by your application, you may use the <code class="docutils literal"><span class="pre">listen</span></code> method. This method is useful for logging queries or debugging. You may register your query listener in a <a class="reference external" href="providers.html">service provider</a>:</p>
<pre class="literal-block">
&lt;?php

namespace App\Providers;

use DB;
use Illuminate\Support\ServiceProvider;

class AppServiceProvider extends ServiceProvider
{
    /**
     * Bootstrap any application services.
     *
     * &#64;return void
     */
    public function boot()
    {
        DB::listen(function($sql, $bindings, $time) {
            //
        });
    }

    /**
     * Register the service provider.
     *
     * &#64;return void
     */
    public function register()
    {
        //
    }
}
</pre>
<p><a name="database-transactions"></a></p>
</div>
</div>
<div class="section" id="database-transactions">
<span id="database-transactions"></span><h2>Database Transactions<a class="headerlink" href="#database-transactions" title="Permalink to this headline">¶</a></h2>
<p>To run a set of operations within a database transaction, you may use the <code class="docutils literal"><span class="pre">transaction</span></code> method on the <code class="docutils literal"><span class="pre">DB</span></code> facade. If an exception is thrown within the transaction <code class="docutils literal"><span class="pre">Closure</span></code>, the transaction will automatically be rolled back. If the <code class="docutils literal"><span class="pre">Closure</span></code> executes successfully, the transaction will automatically be committed. You don&#8217;t need to worry about manually rolling back or committing while using the <code class="docutils literal"><span class="pre">transaction</span></code> method:</p>
<pre class="literal-block">
DB::transaction(function () {
    DB::table('users')-&gt;update(['votes' =&gt; 1]);

    DB::table('posts')-&gt;delete();
});
</pre>
<div class="section" id="manually-using-transactions">
<span id="manually-using-transactions"></span><h3>Manually Using Transactions<a class="headerlink" href="#manually-using-transactions" title="Permalink to this headline">¶</a></h3>
<p>If you would like to begin a transaction manually and have complete control over rollbacks and commits, you may use the <code class="docutils literal"><span class="pre">beginTransaction</span></code> method on the <code class="docutils literal"><span class="pre">DB</span></code> facade:</p>
<pre class="literal-block">
DB::beginTransaction();
</pre>
<p>You can rollback the transaction via the <code class="docutils literal"><span class="pre">rollBack</span></code> method:</p>
<pre class="literal-block">
DB::rollBack();
</pre>
<p>Lastly, you can commit a transaction via the <code class="docutils literal"><span class="pre">commit</span></code> method:</p>
<pre class="literal-block">
DB::commit();
</pre>
<blockquote>
<div><strong>Note:</strong> Using the <code class="docutils literal"><span class="pre">DB</span></code> facade&#8217;s transaction methods also controls transactions for the <a class="reference external" href="queries.html">query builder</a> and <a class="reference external" href="eloquent.html">Eloquent ORM</a>.</div></blockquote>
<p><a name="accessing-connections"></a></p>
</div>
</div>
<div class="section" id="using-multiple-database-connections">
<span id="using-multiple-database-connections"></span><h2>Using Multiple Database Connections<a class="headerlink" href="#using-multiple-database-connections" title="Permalink to this headline">¶</a></h2>
<p>When using multiple connections, you may access each connection via the <code class="docutils literal"><span class="pre">connection</span></code> method on the <code class="docutils literal"><span class="pre">DB</span></code> facade. The <code class="docutils literal"><span class="pre">name</span></code> passed to the <code class="docutils literal"><span class="pre">connection</span></code> method should correspond to one of the connections listed in your <code class="docutils literal"><span class="pre">config/database.php</span></code> configuration file:</p>
<pre class="literal-block">
$users = DB::connection('foo')-&gt;select(...);
</pre>
<p>You may also access the raw, underlying PDO instance using the <code class="docutils literal"><span class="pre">getPdo</span></code> method on a connection instance:</p>
<pre class="literal-block">
$pdo = DB::connection()-&gt;getPdo();
</pre>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, The Weezqyd.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>