

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Laravel Cashier &mdash; Laravel 5 Documentation 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Laravel 5 Documentation 1.0 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Laravel 5 Documentation
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <!-- Local TOC -->
                <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Laravel Cashier</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#composer">Composer</a></li>
<li><a class="reference internal" href="#service-provider">Service Provider</a></li>
<li><a class="reference internal" href="#migration">Migration</a></li>
<li><a class="reference internal" href="#model-setup">Model Setup</a></li>
<li><a class="reference internal" href="#stripe-key">Stripe Key</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#subscriptions">Subscriptions</a><ul>
<li><a class="reference internal" href="#creating-subscriptions">Creating Subscriptions</a><ul>
<li><a class="reference internal" href="#additional-user-details">Additional User Details</a></li>
<li><a class="reference internal" href="#coupons">Coupons</a></li>
</ul>
</li>
<li><a class="reference internal" href="#checking-subscription-status">Checking Subscription Status</a><ul>
<li><a class="reference internal" href="#cancelled-subscription-status">Cancelled Subscription Status</a></li>
</ul>
</li>
<li><a class="reference internal" href="#changing-plans">Changing Plans</a></li>
<li><a class="reference internal" href="#subscription-quantity">Subscription Quantity</a></li>
<li><a class="reference internal" href="#subscription-taxes">Subscription Taxes</a></li>
<li><a class="reference internal" href="#cancelling-subscriptions">Cancelling Subscriptions</a></li>
<li><a class="reference internal" href="#resuming-subscriptions">Resuming Subscriptions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#handling-stripe-webhooks">Handling Stripe Webhooks</a><ul>
<li><a class="reference internal" href="#failed-subscriptions">Failed Subscriptions</a></li>
<li><a class="reference internal" href="#other-webhooks">Other Webhooks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#single-charges">Single Charges</a></li>
<li><a class="reference internal" href="#invoices">Invoices</a><ul>
<li><a class="reference internal" href="#generating-invoice-pdfs">Generating Invoice PDFs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Laravel 5 Documentation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Laravel Cashier</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/billing.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="laravel-cashier">
<span id="laravel-cashier"></span><h1>Laravel Cashier<a class="headerlink" href="#laravel-cashier" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference external" href="#introduction">Introduction</a></li>
<li><a class="reference external" href="#subscriptions">Subscriptions</a><ul>
<li><a class="reference external" href="#creating-subscriptions">Creating Subscriptions</a></li>
<li><a class="reference external" href="#checking-subscription-status">Checking Subscription Status</a></li>
<li><a class="reference external" href="#changing-plans">Changing Plans</a></li>
<li><a class="reference external" href="#subscription-quantity">Subscription Quantity</a></li>
<li><a class="reference external" href="#subscription-taxes">Subscription Taxes</a></li>
<li><a class="reference external" href="#cancelling-subscriptions">Cancelling Subscriptions</a></li>
<li><a class="reference external" href="#resuming-subscriptions">Resuming Subscriptions</a></li>
</ul>
</li>
<li><a class="reference external" href="#handling-stripe-webhooks">Handling Stripe Webhooks</a><ul>
<li><a class="reference external" href="#handling-failed-subscriptions">Failed Subscriptions</a></li>
<li><a class="reference external" href="#handling-other-webhooks">Other Webhooks</a></li>
</ul>
</li>
<li><a class="reference external" href="#single-charges">Single Charges</a></li>
<li><a class="reference external" href="#invoices">Invoices</a><ul>
<li><a class="reference external" href="#generating-invoice-pdfs">Generating Invoice PDFs</a></li>
</ul>
</li>
</ul>
<p><a name="introduction"></a></p>
<div class="section" id="introduction">
<span id="introduction"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Laravel Cashier provides an expressive, fluent interface to <a class="reference external" href="https://stripe.com">Stripe&#8217;s</a> subscription billing services. It handles almost all of the boilerplate subscription billing code you are dreading writing. In addition to basic subscription management, Cashier can handle coupons, swapping subscription, subscription &#8220;quantities&#8221;, cancellation grace periods, and even generate invoice PDFs.</p>
<p><a name="configuration"></a></p>
<div class="section" id="configuration">
<span id="configuration"></span><h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h3>
<div class="section" id="composer">
<span id="composer"></span><h4>Composer<a class="headerlink" href="#composer" title="Permalink to this headline">¶</a></h4>
<p>First, add the Cashier package to your <code class="docutils literal"><span class="pre">composer.json</span></code> file and run the <code class="docutils literal"><span class="pre">composer</span> <span class="pre">update</span></code> command:</p>
<pre class="literal-block">
&quot;laravel/cashier&quot;: &quot;~5.0&quot; (For Stripe SDK ~2.0, and Stripe APIs on 2015-02-18 version and later)
&quot;laravel/cashier&quot;: &quot;~4.0&quot; (For Stripe APIs on 2015-02-18 version and later)
&quot;laravel/cashier&quot;: &quot;~3.0&quot; (For Stripe APIs up to and including 2015-02-16 version)
</pre>
</div>
<div class="section" id="service-provider">
<span id="service-provider"></span><h4>Service Provider<a class="headerlink" href="#service-provider" title="Permalink to this headline">¶</a></h4>
<p>Next, register the <code class="docutils literal"><span class="pre">Laravel\Cashier\CashierServiceProvider</span></code> <a class="reference external" href="providers.html">service provider</a> in your <code class="docutils literal"><span class="pre">app</span></code> configuration file.</p>
</div>
<div class="section" id="migration">
<span id="migration"></span><h4>Migration<a class="headerlink" href="#migration" title="Permalink to this headline">¶</a></h4>
<p>Before using Cashier, we&#8217;ll need to add several columns to your database. Don&#8217;t worry, you can use the <code class="docutils literal"><span class="pre">cashier:table</span></code> Artisan command to create a migration to add the necessary column. For example, to add the column to the users table run the command: <code class="docutils literal"><span class="pre">php</span> <span class="pre">artisan</span> <span class="pre">cashier:table</span> <span class="pre">users</span></code>.</p>
<p>Once the migration has been created, simply run the <code class="docutils literal"><span class="pre">migrate</span></code> command.</p>
</div>
<div class="section" id="model-setup">
<span id="model-setup"></span><h4>Model Setup<a class="headerlink" href="#model-setup" title="Permalink to this headline">¶</a></h4>
<p>Next, add the <code class="docutils literal"><span class="pre">Billable</span></code> trait and appropriate date mutators to your model definition:</p>
<pre class="literal-block">
use Laravel\Cashier\Billable;
use Laravel\Cashier\Contracts\Billable as BillableContract;

class User extends Model implements BillableContract
{
    use Billable;

    protected $dates = ['trial_ends_at', 'subscription_ends_at'];
}
</pre>
<p>Adding the columns to your model&#8217;s <code class="docutils literal"><span class="pre">$dates</span></code> property will instruct Eloquent to return the columns as Carbon / DateTime instances instead of raw strings.</p>
</div>
<div class="section" id="stripe-key">
<span id="stripe-key"></span><h4>Stripe Key<a class="headerlink" href="#stripe-key" title="Permalink to this headline">¶</a></h4>
<p>Finally, set your Stripe key in your <code class="docutils literal"><span class="pre">services.php</span></code> configuration file:</p>
<pre class="literal-block">
'stripe' =&gt; [
    'model'  =&gt; 'User',
    'secret' =&gt; env('STRIPE_API_SECRET'),
],
</pre>
<p><a name="subscriptions"></a></p>
</div>
</div>
</div>
<div class="section" id="subscriptions">
<span id="subscriptions"></span><h2>Subscriptions<a class="headerlink" href="#subscriptions" title="Permalink to this headline">¶</a></h2>
<p><a name="creating-subscriptions"></a></p>
<div class="section" id="creating-subscriptions">
<span id="creating-subscriptions"></span><h3>Creating Subscriptions<a class="headerlink" href="#creating-subscriptions" title="Permalink to this headline">¶</a></h3>
<p>To create a subscription, first retrieve an instance of your billable model, which typically will be an instance of <code class="docutils literal"><span class="pre">App\User</span></code>. Once you have retrieved the model instance, you may use the <code class="docutils literal"><span class="pre">subscription</span></code> method to manage the model&#8217;s subscription:</p>
<pre class="literal-block">
$user = User::find(1);

$user-&gt;subscription('monthly')-&gt;create($creditCardToken);
</pre>
<p>The <code class="docutils literal"><span class="pre">create</span></code> method will automatically create the Stripe subscription, as well as update your database with Stripe customer ID and other relevant billing information. If your plan has a trial configured in Stripe, the trial end date will also automatically be set on the user record.</p>
<p>If you want to implement trial periods, but are managing the trials entirely within your application instead of defining them within Stripe, you must manually set the trial end date:</p>
<pre class="literal-block">
$user-&gt;trial_ends_at = Carbon::now()-&gt;addDays(14);

$user-&gt;save();
</pre>
<div class="section" id="additional-user-details">
<span id="additional-user-details"></span><h4>Additional User Details<a class="headerlink" href="#additional-user-details" title="Permalink to this headline">¶</a></h4>
<p>If you would like to specify additional customer details, you may do so by passing them as the second argument to the <code class="docutils literal"><span class="pre">create</span></code> method:</p>
<pre class="literal-block">
$user-&gt;subscription('monthly')-&gt;create($creditCardToken, [
    'email' =&gt; $email, 'description' =&gt; 'Our First Customer'
]);
</pre>
<p>To learn more about the additional fields supported by Stripe, check out Stripe&#8217;s <a class="reference external" href="https://stripe.com/docs/api#create_customer">documentation on customer creation</a>.</p>
</div>
<div class="section" id="coupons">
<span id="coupons"></span><h4>Coupons<a class="headerlink" href="#coupons" title="Permalink to this headline">¶</a></h4>
<p>If you would like to apply a coupon when creating the subscription, you may use the <code class="docutils literal"><span class="pre">withCoupon</span></code> method:</p>
<pre class="literal-block">
$user-&gt;subscription('monthly')
     -&gt;withCoupon('code')
     -&gt;create($creditCardToken);
</pre>
<p><a name="checking-subscription-status"></a></p>
</div>
</div>
<div class="section" id="checking-subscription-status">
<span id="checking-subscription-status"></span><h3>Checking Subscription Status<a class="headerlink" href="#checking-subscription-status" title="Permalink to this headline">¶</a></h3>
<p>Once a user is subscribed to your application, you may easily check their subscription status using a variety of convenient methods. First, the <code class="docutils literal"><span class="pre">subscribed</span></code> method returns <code class="docutils literal"><span class="pre">true</span></code> if the user has an active subscription, even if the subscription is currently within its trial period:</p>
<pre class="literal-block">
if ($user-&gt;subscribed()) {
    //
}
</pre>
<p>The <code class="docutils literal"><span class="pre">subscribed</span></code> method also makes a great candidate for a <a class="reference external" href="middleware.html">route middleware</a>, allowing you to filter access to routes and controllers based on the user&#8217;s subscription status:</p>
<pre class="literal-block">
public function handle($request, Closure $next)
{
    if ($request-&gt;user() &amp;&amp; ! $request-&gt;user()-&gt;subscribed()) {
        // This user is not a paying customer...
        return redirect('billing');
    }

    return $next($request);
}
</pre>
<p>If you would like to determine if a user is still within their trial period, you may use the <code class="docutils literal"><span class="pre">onTrial</span></code> method. This method can be useful for displaying a warning to the user that they are still on their trial period:</p>
<pre class="literal-block">
if ($user-&gt;onTrial()) {
    //
}
</pre>
<p>The <code class="docutils literal"><span class="pre">onPlan</span></code> method may be used to determine if the user is subscribed to a given plan based on its Stripe ID:</p>
<pre class="literal-block">
if ($user-&gt;onPlan('monthly')) {
    //
}
</pre>
<div class="section" id="cancelled-subscription-status">
<span id="cancelled-subscription-status"></span><h4>Cancelled Subscription Status<a class="headerlink" href="#cancelled-subscription-status" title="Permalink to this headline">¶</a></h4>
<p>To determine if the user was once an active subscriber, but has cancelled their subscription, you may use the <code class="docutils literal"><span class="pre">cancelled</span></code> method:</p>
<pre class="literal-block">
if ($user-&gt;cancelled()) {
    //
}
</pre>
<p>You may also determine if a user has cancelled their subscription, but are still on their &#8220;grace period&#8221; until the subscription fully expires. For example, if a user cancels a subscription on March 5th that was originally scheduled to expire on March 10th, the user is on their &#8220;grace period&#8221; until March 10th. Note that the <code class="docutils literal"><span class="pre">subscribed</span></code> method still returns <code class="docutils literal"><span class="pre">true</span></code> during this time.</p>
<pre class="literal-block">
if ($user-&gt;onGracePeriod()) {
    //
}
</pre>
<p>The <code class="docutils literal"><span class="pre">everSubscribed</span></code> method may be used to determine if the user has ever subscribed to a plan in your application:</p>
<pre class="literal-block">
if ($user-&gt;everSubscribed()) {
    //
}
</pre>
<p><a name="changing-plans"></a></p>
</div>
</div>
<div class="section" id="changing-plans">
<span id="changing-plans"></span><h3>Changing Plans<a class="headerlink" href="#changing-plans" title="Permalink to this headline">¶</a></h3>
<p>After a user is subscribed to your application, they may occasionally want to change to a new subscription plan. To swap a user to a new subscription, use the <code class="docutils literal"><span class="pre">swap</span></code> method. For example, we may easily switch a user to the <code class="docutils literal"><span class="pre">premium</span></code> subscription:</p>
<pre class="literal-block">
$user = App\User::find(1);

$user-&gt;subscription('premium')-&gt;swap();
</pre>
<p>If the user is on trial, the trial period will be maintained. Also, if a &#8220;quantity&#8221; exists for the subscription, that quantity will also be maintained. When swapping plans, you may also use the <code class="docutils literal"><span class="pre">prorate</span></code> method to indicate that the charges should be pro-rated. In addition, you may use the <code class="docutils literal"><span class="pre">swapAndInvoice</span></code> method to immediately invoice the user for the plan change:</p>
<pre class="literal-block">
$user-&gt;subscription('premium')
            -&gt;prorate()
            -&gt;swapAndInvoice();
</pre>
<p><a name="subscription-quantity"></a></p>
</div>
<div class="section" id="subscription-quantity">
<span id="subscription-quantity"></span><h3>Subscription Quantity<a class="headerlink" href="#subscription-quantity" title="Permalink to this headline">¶</a></h3>
<p>Sometimes subscriptions are affected by &#8220;quantity&#8221;. For example, your application might charge $10 per month <strong>per user</strong> on an account. To easily increment or decrement your subscription quantity, use the <code class="docutils literal"><span class="pre">increment</span></code> and <code class="docutils literal"><span class="pre">decrement</span></code> methods:</p>
<pre class="literal-block">
$user = User::find(1);

$user-&gt;subscription()-&gt;increment();

// Add five to the subscription's current quantity...
$user-&gt;subscription()-&gt;increment(5);

$user-&gt;subscription()-&gt;decrement();

// Subtract five to the subscription's current quantity...
$user-&gt;subscription()-&gt;decrement(5);
</pre>
<p>Alternatively, you may set a specific quantity using the <code class="docutils literal"><span class="pre">updateQuantity</span></code> method:</p>
<pre class="literal-block">
$user-&gt;subscription()-&gt;updateQuantity(10);
</pre>
<p>For more information on subscription quantities, consult the <a class="reference external" href="https://stripe.com/docs/guides/subscriptions#setting-quantities">Stripe documentation</a>.</p>
<p><a name="subscription-taxes"></a></p>
</div>
<div class="section" id="subscription-taxes">
<span id="subscription-taxes"></span><h3>Subscription Taxes<a class="headerlink" href="#subscription-taxes" title="Permalink to this headline">¶</a></h3>
<p>With Cashier, it&#8217;s easy to provide the <code class="docutils literal"><span class="pre">tax_percent</span></code> value sent to Stripe. To specify the tax percentage a user pays on a subscription, implement the <code class="docutils literal"><span class="pre">getTaxPercent</span></code> method on your billable model, and return a numeric value between 0 and 100, with no more than 2 decimal places.</p>
<pre class="literal-block">
public function getTaxPercent() {
    return 20;
}
</pre>
<p>This enables you to apply a tax rate on a model-by-model basis, which may be helpful for a user base that spans multiple countries.</p>
<p><a name="cancelling-subscriptions"></a></p>
</div>
<div class="section" id="cancelling-subscriptions">
<span id="cancelling-subscriptions"></span><h3>Cancelling Subscriptions<a class="headerlink" href="#cancelling-subscriptions" title="Permalink to this headline">¶</a></h3>
<p>To cancel a subscription, simply call the <code class="docutils literal"><span class="pre">cancel</span></code> method on the user&#8217;s subscription:</p>
<pre class="literal-block">
$user-&gt;subscription()-&gt;cancel();
</pre>
<p>When a subscription is cancelled, Cashier will automatically set the <code class="docutils literal"><span class="pre">subscription_ends_at</span></code> column in your database. This column is used to know when the <code class="docutils literal"><span class="pre">subscribed</span></code> method should begin returning <code class="docutils literal"><span class="pre">false</span></code>. For example, if a customer cancels a subscription on March 1st, but the subscription was not scheduled to end until March 5th, the <code class="docutils literal"><span class="pre">subscribed</span></code> method will continue to return <code class="docutils literal"><span class="pre">true</span></code> until March 5th.</p>
<p>You may determine if a user has cancelled their subscription but are still on their &#8220;grace period&#8221; using the <code class="docutils literal"><span class="pre">onGracePeriod</span></code> method:</p>
<pre class="literal-block">
if ($user-&gt;onGracePeriod()) {
    //
}
</pre>
<p><a name="resuming-subscriptions"></a></p>
</div>
<div class="section" id="resuming-subscriptions">
<span id="resuming-subscriptions"></span><h3>Resuming Subscriptions<a class="headerlink" href="#resuming-subscriptions" title="Permalink to this headline">¶</a></h3>
<p>If a user has cancelled their subscription and you wish to resume it, use the <code class="docutils literal"><span class="pre">resume</span></code> method:</p>
<pre class="literal-block">
$user-&gt;subscription('monthly')-&gt;resume($creditCardToken);
</pre>
<p>If the user cancels a subscription and then resumes that subscription before the subscription has fully expired, they will not be billed immediately. Instead, their subscription will simply be re-activated, and they will be billed on the original billing cycle.</p>
<p><a name="handling-stripe-webhooks"></a></p>
</div>
</div>
<div class="section" id="handling-stripe-webhooks">
<span id="handling-stripe-webhooks"></span><h2>Handling Stripe Webhooks<a class="headerlink" href="#handling-stripe-webhooks" title="Permalink to this headline">¶</a></h2>
<p><a name="handling-failed-subscriptions"></a></p>
<div class="section" id="failed-subscriptions">
<span id="failed-subscriptions"></span><h3>Failed Subscriptions<a class="headerlink" href="#failed-subscriptions" title="Permalink to this headline">¶</a></h3>
<p>What if a customer&#8217;s credit card expires? No worries - Cashier includes a Webhook controller that can easily cancel the customer&#8217;s subscription for you. Just point a route to the controller:</p>
<pre class="literal-block">
Route::post('stripe/webhook', '\Laravel\Cashier\WebhookController&#64;handleWebhook');
</pre>
<p>That&#8217;s it! Failed payments will be captured and handled by the controller. The controller will cancel the customer&#8217;s subscription when Stripe determines the subscription has failed (normally after three failed payment attempts). Don&#8217;t forget: you will need to configure the webhook URI in your Stripe control panel settings.</p>
<p>Since Stripe webhooks need to bypass Laravel&#8217;s <a class="reference external" href="routing.html#csrf-protection">CSRF verification</a>, be sure to list the URI an exception in your <code class="docutils literal"><span class="pre">VerifyCsrfToken</span></code> middleware:</p>
<pre class="literal-block">
protected $except = [
    'stripe/*',
];
</pre>
<p><a name="handling-other-webhooks"></a></p>
</div>
<div class="section" id="other-webhooks">
<span id="other-webhooks"></span><h3>Other Webhooks<a class="headerlink" href="#other-webhooks" title="Permalink to this headline">¶</a></h3>
<p>If you have additional Stripe webhook events you would like to handle, simply extend the Webhook controller. Your method names should correspond to Cashier&#8217;s expected convention, specifically, methods should be prefixed with <code class="docutils literal"><span class="pre">handle</span></code> and the &#8220;camel case&#8221; name of the Stripe webhook you wish to handle. For example, if you wish to handle the <code class="docutils literal"><span class="pre">invoice.payment_succeeded</span></code> webhook, you should add a <code class="docutils literal"><span class="pre">handleInvoicePaymentSucceeded</span></code> method to the controller.</p>
<pre class="literal-block">
&lt;?php

namespace App\Http\Controller;

use Laravel\Cashier\WebhookController as BaseController;

class WebhookController extends BaseController
{
    /**
     * Handle a stripe webhook.
     *
     * &#64;param  array  $payload
     * &#64;return Response
     */
    public function handleInvoicePaymentSucceeded($payload)
    {
        // Handle The Event
    }
}
</pre>
<p><a name="single-charges"></a></p>
</div>
</div>
<div class="section" id="single-charges">
<span id="single-charges"></span><h2>Single Charges<a class="headerlink" href="#single-charges" title="Permalink to this headline">¶</a></h2>
<p>If you would like to make a &#8220;one off&#8221; charge against a subscribed customer&#8217;s credit card, you may use the <code class="docutils literal"><span class="pre">charge</span></code> method on a billable model instance. The <code class="docutils literal"><span class="pre">charge</span></code> method accepts the amount you would like to charge in the <strong>lowest denominator of the currency used by your application</strong>. So, for example, the example below will charge 100 cents, or $1.00, against the user&#8217;s credit card:</p>
<pre class="literal-block">
$user-&gt;charge(100);
</pre>
<p>The <code class="docutils literal"><span class="pre">charge</span></code> method accepts an array as its second argument, allowing you to pass any options you wish to the underlying Stripe charge creation:</p>
<pre class="literal-block">
$user-&gt;charge(100, [
    'source' =&gt; $token,
    'receipt_email' =&gt; $user-&gt;email,
]);
</pre>
<p>The <code class="docutils literal"><span class="pre">charge</span></code> method will return <code class="docutils literal"><span class="pre">false</span></code> if the charge fails. This typically indicates the charge was denied:</p>
<pre class="literal-block">
if ( ! $user-&gt;charge(100)) {
    // The charge was denied...
}
</pre>
<p>If the charge is successful, the full Stripe response will be returned from the method.</p>
<p><a name="invoices"></a></p>
</div>
<div class="section" id="invoices">
<span id="invoices"></span><h2>Invoices<a class="headerlink" href="#invoices" title="Permalink to this headline">¶</a></h2>
<p>You may easily retrieve an array of a billable model&#8217;s invoices using the <code class="docutils literal"><span class="pre">invoices</span></code> method:</p>
<pre class="literal-block">
$invoices = $user-&gt;invoices();
</pre>
<p>When listing the invoices for the customer, you may use the invoice&#8217;s helper methods to display the relevant invoice information. For example, you may wish to list every invoice in a table, allowing the user to easily download any of them:</p>
<pre class="literal-block">
&lt;table&gt;
    &#64;foreach ($invoices as $invoice)
        &lt;tr&gt;
            &lt;td&gt;{{ $invoice-&gt;dateString() }}&lt;/td&gt;
            &lt;td&gt;{{ $invoice-&gt;dollars() }}&lt;/td&gt;
            &lt;td&gt;&lt;a href=&quot;/user/invoice/{{ $invoice-&gt;id }}&quot;&gt;Download&lt;/a&gt;&lt;/td&gt;
        &lt;/tr&gt;
    &#64;endforeach
&lt;/table&gt;
</pre>
<p><a name="generating-invoice-pdfs"></a></p>
<div class="section" id="generating-invoice-pdfs">
<span id="generating-invoice-pdfs"></span><h3>Generating Invoice PDFs<a class="headerlink" href="#generating-invoice-pdfs" title="Permalink to this headline">¶</a></h3>
<p>From within a route or controller, use the <code class="docutils literal"><span class="pre">downloadInvoice</span></code> method to generate a PDF download of the invoice. This method will automatically generate the proper HTTP response to send the download to the browser:</p>
<pre class="literal-block">
Route::get('user/invoice/{invoice}', function ($invoiceId) {
    return Auth::user()-&gt;downloadInvoice($invoiceId, [
        'vendor'  =&gt; 'Your Company',
        'product' =&gt; 'Your Product',
    ]);
});
</pre>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, The Weezqyd.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>