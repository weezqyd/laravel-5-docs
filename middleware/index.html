<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Middleware - Laravel 5.4 Official Documentation</title>
      
      
      
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="Laravel 5.4 Official Documentation">
    <meta property="og:image" content="None/../">
    <meta name="apple-mobile-web-app-title" content="Laravel 5.4 Official Documentation">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../assets/fonts/icon.eot?52m981');
      	src: url('../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../assets/stylesheets/application-a422ff04cc.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/palettes-05ab2406df.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
    <script src="../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class="palette-primary-teal palette-accent-green">
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
          </span>
        
        Middleware
      </div>
    </div>
    
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="/" class="project">
    <div class="banner">
      
      <div class="name">
        <strong>
          Laravel 5.4 Official Documentation
          <span class="version">
            
          </span>
        </strong>
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Home" href="..">
      Home
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Apis" href="../apis/">
      Apis
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Artisan" href="../artisan/">
      Artisan
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Authentication" href="../authentication/">
      Authentication
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Authorization" href="../authorization/">
      Authorization
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Billing" href="../billing/">
      Billing
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Blade" href="../blade/">
      Blade
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Broadcasting" href="../broadcasting/">
      Broadcasting
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Cache" href="../cache/">
      Cache
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Collections" href="../collections/">
      Collections
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Configuration" href="../configuration/">
      Configuration
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Container" href="../container/">
      Container
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Contracts" href="../contracts/">
      Contracts
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Contributing" href="../contributing/">
      Contributing
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Contributions" href="../contributions/">
      Contributions
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Controllers" href="../controllers/">
      Controllers
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Csrf" href="../csrf/">
      Csrf
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Database testing" href="../database-testing/">
      Database testing
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Database" href="../database/">
      Database
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Documentation" href="../documentation/">
      Documentation
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Dusk" href="../dusk/">
      Dusk
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Eloquent collections" href="../eloquent-collections/">
      Eloquent collections
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Eloquent mutators" href="../eloquent-mutators/">
      Eloquent mutators
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Eloquent relationships" href="../eloquent-relationships/">
      Eloquent relationships
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Eloquent serialization" href="../eloquent-serialization/">
      Eloquent serialization
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Eloquent" href="../eloquent/">
      Eloquent
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Encryption" href="../encryption/">
      Encryption
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Envoy" href="../envoy/">
      Envoy
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Errors" href="../errors/">
      Errors
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Events" href="../events/">
      Events
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Facades" href="../facades/">
      Facades
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Filesystem" href="../filesystem/">
      Filesystem
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Frontend" href="../frontend/">
      Frontend
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Hashing" href="../hashing/">
      Hashing
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Helpers" href="../helpers/">
      Helpers
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Homestead" href="../homestead/">
      Homestead
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Http tests" href="../http-tests/">
      Http tests
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Installation" href="../installation/">
      Installation
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="License" href="../license/">
      License
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Lifecycle" href="../lifecycle/">
      Lifecycle
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Localization" href="../localization/">
      Localization
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Mail" href="../mail/">
      Mail
    </a>
    
  </li>

          
            
  <li>
    <a class="current" title="Middleware" href="./">
      Middleware
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="Introduction" href="#introduction">
                Introduction
              </a>
            </li>
          
            <li class="anchor">
              <a title="Defining Middleware" href="#defining-middleware">
                Defining Middleware
              </a>
            </li>
          
            <li class="anchor">
              <a title="Registering Middleware" href="#registering-middleware">
                Registering Middleware
              </a>
            </li>
          
            <li class="anchor">
              <a title="Middleware Parameters" href="#middleware-parameters">
                Middleware Parameters
              </a>
            </li>
          
            <li class="anchor">
              <a title="Terminable Middleware" href="#terminable-middleware">
                Terminable Middleware
              </a>
            </li>
          
        </ul>
      
    
  </li>

          
            
  <li>
    <a class="" title="Migrations" href="../migrations/">
      Migrations
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Mix" href="../mix/">
      Mix
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Mocking" href="../mocking/">
      Mocking
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Notifications" href="../notifications/">
      Notifications
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Packages" href="../packages/">
      Packages
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Pagination" href="../pagination/">
      Pagination
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Passport" href="../passport/">
      Passport
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Passwords" href="../passwords/">
      Passwords
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Providers" href="../providers/">
      Providers
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Queries" href="../queries/">
      Queries
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Queues" href="../queues/">
      Queues
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Redirects" href="../redirects/">
      Redirects
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Redis" href="../redis/">
      Redis
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Releases" href="../releases/">
      Releases
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Requests" href="../requests/">
      Requests
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Responses" href="../responses/">
      Responses
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Routing" href="../routing/">
      Routing
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Scheduling" href="../scheduling/">
      Scheduling
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Scout" href="../scout/">
      Scout
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Seeding" href="../seeding/">
      Seeding
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Session" href="../session/">
      Session
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Structure" href="../structure/">
      Structure
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Testing" href="../testing/">
      Testing
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Upgrade" href="../upgrade/">
      Upgrade
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Valet" href="../valet/">
      Valet
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Validation" href="../validation/">
      Validation
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Views" href="../views/">
      Views
    </a>
    
  </li>

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <h1 id="middleware">Middleware</h1>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#defining-middleware">Defining Middleware</a></li>
<li><a href="#registering-middleware">Registering Middleware</a><ul>
<li><a href="#global-middleware">Global Middleware</a></li>
<li><a href="#assigning-middleware-to-routes">Assigning Middleware To Routes</a></li>
<li><a href="#middleware-groups">Middleware Groups</a></li>
</ul>
</li>
<li><a href="#middleware-parameters">Middleware Parameters</a></li>
<li><a href="#terminable-middleware">Terminable Middleware</a></li>
</ul>
<p><a name="introduction"></a></p>
<h2 id="introduction">Introduction</h2>
<p>Middleware provide a convenient mechanism for filtering HTTP requests entering your application. For example, Laravel includes a middleware that verifies the user of your application is authenticated. If the user is not authenticated, the middleware will redirect the user to the login screen. However, if the user is authenticated, the middleware will allow the request to proceed further into the application.</p>
<p>Of course, additional middleware can be written to perform a variety of tasks besides authentication. A CORS middleware might be responsible for adding the proper headers to all responses leaving your application. A logging middleware might log all incoming requests to your application.</p>
<p>There are several middleware included in the Laravel framework, including middleware for authentication and CSRF protection. All of these middleware are located in the <code>app/Http/Middleware</code> directory.</p>
<p><a name="defining-middleware"></a></p>
<h2 id="defining-middleware">Defining Middleware</h2>
<p>To create a new middleware, use the <code>make:middleware</code> Artisan command:</p>
<div class="codehilite"><pre><span></span>php artisan make:middleware CheckAge
</pre></div>


<p>This command will place a new <code>CheckAge</code> class within your <code>app/Http/Middleware</code> directory. In this middleware, we will only allow access to the route if the supplied <code>age</code> is greater than 200. Otherwise, we will redirect the users back to the <code>home</code> URI.</p>
<div class="codehilite"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nx">namespace</span> <span class="nx">App</span><span class="err">\</span><span class="nx">Http</span><span class="err">\</span><span class="nx">Middleware</span><span class="p">;</span>

<span class="nx">use</span> <span class="nx">Closure</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">CheckAge</span>
<span class="p">{</span>
    <span class="cm">/**</span>
<span class="cm">     * Handle an incoming request.</span>
<span class="cm">     *</span>
<span class="cm">     * @param  \Illuminate\Http\Request  $request</span>
<span class="cm">     * @param  \Closure  $next</span>
<span class="cm">     * @return mixed</span>
<span class="cm">     */</span>
    <span class="kr">public</span> <span class="kd">function</span> <span class="nx">handle</span><span class="p">(</span><span class="nx">$request</span><span class="p">,</span> <span class="nx">Closure</span> <span class="nx">$next</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">$request</span><span class="o">-&gt;</span><span class="nx">age</span> <span class="o">&lt;=</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">redirect</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">$next</span><span class="p">(</span><span class="nx">$request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>


<p>As you can see, if the given <code>age</code> is less than or equal to <code>200</code>, the middleware will return an HTTP redirect to the client; otherwise, the request will be passed further into the application. To pass the request deeper into the application (allowing the middleware to "pass"), simply call the <code>$next</code> callback with the <code>$request</code>.</p>
<p>It's best to envision middleware as a series of "layers" HTTP requests must pass through before they hit your application. Each layer can examine the request and even reject it entirely.</p>
<h3 id="before-after-middleware">Before &amp; After Middleware</h3>
<p>Whether a middleware runs before or after a request depends on the middleware itself. For example, the following middleware would perform some task <strong>before</strong> the request is handled by the application:</p>
<div class="codehilite"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nx">namespace</span> <span class="nx">App</span><span class="err">\</span><span class="nx">Http</span><span class="err">\</span><span class="nx">Middleware</span><span class="p">;</span>

<span class="nx">use</span> <span class="nx">Closure</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">BeforeMiddleware</span>
<span class="p">{</span>
    <span class="kr">public</span> <span class="kd">function</span> <span class="nx">handle</span><span class="p">(</span><span class="nx">$request</span><span class="p">,</span> <span class="nx">Closure</span> <span class="nx">$next</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Perform action</span>

        <span class="k">return</span> <span class="nx">$next</span><span class="p">(</span><span class="nx">$request</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>However, this middleware would perform its task <strong>after</strong> the request is handled by the application:</p>
<div class="codehilite"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nx">namespace</span> <span class="nx">App</span><span class="err">\</span><span class="nx">Http</span><span class="err">\</span><span class="nx">Middleware</span><span class="p">;</span>

<span class="nx">use</span> <span class="nx">Closure</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">AfterMiddleware</span>
<span class="p">{</span>
    <span class="kr">public</span> <span class="kd">function</span> <span class="nx">handle</span><span class="p">(</span><span class="nx">$request</span><span class="p">,</span> <span class="nx">Closure</span> <span class="nx">$next</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">$response</span> <span class="o">=</span> <span class="nx">$next</span><span class="p">(</span><span class="nx">$request</span><span class="p">);</span>

        <span class="c1">// Perform action</span>

        <span class="k">return</span> <span class="nx">$response</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p><a name="registering-middleware"></a></p>
<h2 id="registering-middleware">Registering Middleware</h2>
<p><a name="global-middleware"></a></p>
<h3 id="global-middleware">Global Middleware</h3>
<p>If you want a middleware to run during every HTTP request to your application, simply list the middleware class in the <code>$middleware</code> property of your <code>app/Http/Kernel.php</code> class.</p>
<p><a name="assigning-middleware-to-routes"></a></p>
<h3 id="assigning-middleware-to-routes">Assigning Middleware To Routes</h3>
<p>If you would like to assign middleware to specific routes, you should first assign the middleware a key in your <code>app/Http/Kernel.php</code> file. By default, the <code>$routeMiddleware</code> property of this class contains entries for the middleware included with Laravel. To add your own, simply append it to this list and assign it a key of your choosing. For example:</p>
<div class="codehilite"><pre><span></span>// Within App\Http\Kernel Class...

protected $routeMiddleware = [
    &#39;auth&#39; =&gt; \Illuminate\Auth\Middleware\Authenticate::class,
    &#39;auth.basic&#39; =&gt; \Illuminate\Auth\Middleware\AuthenticateWithBasicAuth::class,
    &#39;bindings&#39; =&gt; \Illuminate\Routing\Middleware\SubstituteBindings::class,
    &#39;can&#39; =&gt; \Illuminate\Auth\Middleware\Authorize::class,
    &#39;guest&#39; =&gt; \App\Http\Middleware\RedirectIfAuthenticated::class,
    &#39;throttle&#39; =&gt; \Illuminate\Routing\Middleware\ThrottleRequests::class,
];
</pre></div>


<p>Once the middleware has been defined in the HTTP kernel, you may use the <code>middleware</code> method to assign middleware to a route:</p>
<div class="codehilite"><pre><span></span>Route::get(&#39;admin/profile&#39;, function () {
    //
})-&gt;middleware(&#39;auth&#39;);
</pre></div>


<p>You may also assign multiple middleware to the route:</p>
<div class="codehilite"><pre><span></span>Route::get(&#39;/&#39;, function () {
    //
})-&gt;middleware(&#39;first&#39;, &#39;second&#39;);
</pre></div>


<p>When assigning middleware, you may also pass the fully qualified class name:</p>
<div class="codehilite"><pre><span></span><span class="nt">use</span> <span class="nt">App</span><span class="err">\</span><span class="nt">Http</span><span class="err">\</span><span class="nt">Middleware</span><span class="err">\</span><span class="nt">CheckAge</span><span class="o">;</span>

<span class="nt">Route</span><span class="p">::</span><span class="nd">get</span><span class="o">(</span><span class="s1">&#39;admin/profile&#39;</span><span class="o">,</span> <span class="nt">function</span> <span class="o">()</span> <span class="p">{</span>
    <span class="err">//</span>
<span class="p">}</span><span class="o">)</span><span class="nt">-</span><span class="o">&gt;</span><span class="nt">middleware</span><span class="o">(</span><span class="nt">CheckAge</span><span class="p">::</span><span class="nd">class</span><span class="o">);</span>
</pre></div>


<p><a name="middleware-groups"></a></p>
<h3 id="middleware-groups">Middleware Groups</h3>
<p>Sometimes you may want to group several middleware under a single key to make them easier to assign to routes. You may do this using the <code>$middlewareGroups</code> property of your HTTP kernel.</p>
<p>Out of the box, Laravel comes with <code>web</code> and <code>api</code> middleware groups that contains common middleware you may want to apply to your web UI and API routes:</p>
<div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * The application&#39;s route middleware groups.</span>
<span class="cm"> *</span>
<span class="cm"> * @var array</span>
<span class="cm"> */</span><span class="w"></span>
protected<span class="w"> </span><span class="err">$</span>middlewareGroups<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[</span><span class="w"></span>
<span class="w">    </span><span class="s">&#39;web&#39;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">[</span><span class="w"></span>
<span class="w">        </span><span class="o">\</span>App<span class="o">\</span>Http<span class="o">\</span>Middleware<span class="o">\</span><span class="nl">EncryptCookies</span><span class="o">:</span><span class="err">:</span>class<span class="o">,</span><span class="w"></span>
<span class="w">        </span><span class="o">\</span>Illuminate<span class="o">\</span>Cookie<span class="o">\</span>Middleware<span class="o">\</span><span class="nl">AddQueuedCookiesToResponse</span><span class="o">:</span><span class="err">:</span>class<span class="o">,</span><span class="w"></span>
<span class="w">        </span><span class="o">\</span>Illuminate<span class="o">\</span>Session<span class="o">\</span>Middleware<span class="o">\</span><span class="nl">StartSession</span><span class="o">:</span><span class="err">:</span>class<span class="o">,</span><span class="w"></span>
<span class="w">        </span><span class="o">\</span>Illuminate<span class="o">\</span>View<span class="o">\</span>Middleware<span class="o">\</span><span class="nl">ShareErrorsFromSession</span><span class="o">:</span><span class="err">:</span>class<span class="o">,</span><span class="w"></span>
<span class="w">        </span><span class="o">\</span>App<span class="o">\</span>Http<span class="o">\</span>Middleware<span class="o">\</span><span class="nl">VerifyCsrfToken</span><span class="o">:</span><span class="err">:</span>class<span class="o">,</span><span class="w"></span>
<span class="w">        </span><span class="o">\</span>Illuminate<span class="o">\</span>Routing<span class="o">\</span>Middleware<span class="o">\</span><span class="nl">SubstituteBindings</span><span class="o">:</span><span class="err">:</span>class<span class="o">,</span><span class="w"></span>
<span class="w">    </span><span class="err">]</span><span class="o">,</span><span class="w"></span>

<span class="w">    </span><span class="s">&#39;api&#39;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">[</span><span class="w"></span>
<span class="w">        </span><span class="s">&#39;throttle:60,1&#39;</span><span class="o">,</span><span class="w"></span>
<span class="w">        </span><span class="s">&#39;auth:api&#39;</span><span class="o">,</span><span class="w"></span>
<span class="w">    </span><span class="err">]</span><span class="o">,</span><span class="w"></span>
<span class="err">];</span><span class="w"></span>
</pre></div>


<p>Middleware groups may be assigned to routes and controller actions using the same syntax as individual middleware. Again, middleware groups simply make it more convenient to assign many middleware to a route at once:</p>
<div class="codehilite"><pre><span></span>Route::get(&#39;/&#39;, function () {
    //
})-&gt;middleware(&#39;web&#39;);

Route::group([&#39;middleware&#39; =&gt; [&#39;web&#39;]], function () {
    //
});
</pre></div>


<blockquote>
<p>{tip} Out of the box, the <code>web</code> middleware group is automatically applied to your <code>routes/web.php</code> file by the <code>RouteServiceProvider</code>.</p>
</blockquote>
<p><a name="middleware-parameters"></a></p>
<h2 id="middleware-parameters">Middleware Parameters</h2>
<p>Middleware can also receive additional parameters. For example, if your application needs to verify that the authenticated user has a given "role" before performing a given action, you could create a <code>CheckRole</code> middleware that receives a role name as an additional argument.</p>
<p>Additional middleware parameters will be passed to the middleware after the <code>$next</code> argument:</p>
<div class="codehilite"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nx">namespace</span> <span class="nx">App</span><span class="err">\</span><span class="nx">Http</span><span class="err">\</span><span class="nx">Middleware</span><span class="p">;</span>

<span class="nx">use</span> <span class="nx">Closure</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">CheckRole</span>
<span class="p">{</span>
    <span class="cm">/**</span>
<span class="cm">     * Handle the incoming request.</span>
<span class="cm">     *</span>
<span class="cm">     * @param  \Illuminate\Http\Request  $request</span>
<span class="cm">     * @param  \Closure  $next</span>
<span class="cm">     * @param  string  $role</span>
<span class="cm">     * @return mixed</span>
<span class="cm">     */</span>
    <span class="kr">public</span> <span class="kd">function</span> <span class="nx">handle</span><span class="p">(</span><span class="nx">$request</span><span class="p">,</span> <span class="nx">Closure</span> <span class="nx">$next</span><span class="p">,</span> <span class="nx">$role</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nx">$request</span><span class="o">-&gt;</span><span class="nx">user</span><span class="p">()</span><span class="o">-&gt;</span><span class="nx">hasRole</span><span class="p">(</span><span class="nx">$role</span><span class="p">))</span> <span class="p">{</span>
            <span class="c1">// Redirect...</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">$next</span><span class="p">(</span><span class="nx">$request</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>


<p>Middleware parameters may be specified when defining the route by separating the middleware name and parameters with a <code>:</code>. Multiple parameters should be delimited by commas:</p>
<div class="codehilite"><pre><span></span><span class="nt">Route</span><span class="p">::</span><span class="nd">put</span><span class="o">(</span><span class="s1">&#39;post/{id}&#39;</span><span class="o">,</span> <span class="nt">function</span> <span class="o">($</span><span class="nt">id</span><span class="o">)</span> <span class="p">{</span>
    <span class="err">//</span>
<span class="p">}</span><span class="o">)</span><span class="nt">-</span><span class="o">&gt;</span><span class="nt">middleware</span><span class="o">(</span><span class="s1">&#39;role:editor&#39;</span><span class="o">);</span>
</pre></div>


<p><a name="terminable-middleware"></a></p>
<h2 id="terminable-middleware">Terminable Middleware</h2>
<p>Sometimes a middleware may need to do some work after the HTTP response has been sent to the browser. For example, the "session" middleware included with Laravel writes the session data to storage after the response has been sent to the browser. If you define a <code>terminate</code> method on your middleware, it will automatically be called after the response is sent to the browser.</p>
<div class="codehilite"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nx">namespace</span> <span class="nx">Illuminate</span><span class="err">\</span><span class="nx">Session</span><span class="err">\</span><span class="nx">Middleware</span><span class="p">;</span>

<span class="nx">use</span> <span class="nx">Closure</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">StartSession</span>
<span class="p">{</span>
    <span class="kr">public</span> <span class="kd">function</span> <span class="nx">handle</span><span class="p">(</span><span class="nx">$request</span><span class="p">,</span> <span class="nx">Closure</span> <span class="nx">$next</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nx">$next</span><span class="p">(</span><span class="nx">$request</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kr">public</span> <span class="kd">function</span> <span class="nx">terminate</span><span class="p">(</span><span class="nx">$request</span><span class="p">,</span> <span class="nx">$response</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Store the session data...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>The <code>terminate</code> method should receive both the request and the response. Once you have defined a terminable middleware, you should add it to the list of route or global middleware in the <code>app/Http/Kernel.php</code> file.</p>
<p>When calling the <code>terminate</code> method on your middleware, Laravel will resolve a fresh instance of the middleware from the <a href="../docs/{{version}}/container">service container</a>. If you would like to use the same middleware instance when the <code>handle</code> and <code>terminate</code> methods are called, register the middleware with the container using the container's <code>singleton</code> method.</p>
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../mail/" title="Mail">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Mail
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../migrations/" title="Migrations">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Migrations
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '..';
      var repo_id  = '';
    </script>
    <script src="../assets/javascripts/application-997097ee0c.js"></script>
    
    
  </body>
</html>