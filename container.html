

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Service Container &mdash; Laravel 5 Documentation 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Laravel 5 Documentation 1.0 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Laravel 5 Documentation
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <!-- Local TOC -->
                <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Service Container</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#binding">Binding</a><ul>
<li><a class="reference internal" href="#binding-a-singleton">Binding A Singleton</a></li>
<li><a class="reference internal" href="#binding-instances">Binding Instances</a></li>
<li><a class="reference internal" href="#binding-interfaces-to-implementations">Binding Interfaces To Implementations</a></li>
<li><a class="reference internal" href="#contextual-binding">Contextual Binding</a></li>
<li><a class="reference internal" href="#tagging">Tagging</a></li>
</ul>
</li>
<li><a class="reference internal" href="#resolving">Resolving</a></li>
<li><a class="reference internal" href="#container-events">Container Events</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Laravel 5 Documentation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Service Container</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/container.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="service-container">
<span id="service-container"></span><h1>Service Container<a class="headerlink" href="#service-container" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference external" href="#introduction">Introduction</a></li>
<li><a class="reference external" href="#binding">Binding</a><ul>
<li><a class="reference external" href="#binding-interfaces-to-implementations">Binding Interfaces To Implementations</a></li>
<li><a class="reference external" href="#contextual-binding">Contextual Binding</a></li>
<li><a class="reference external" href="#tagging">Tagging</a></li>
</ul>
</li>
<li><a class="reference external" href="#resolving">Resolving</a></li>
<li><a class="reference external" href="#container-events">Container Events</a></li>
</ul>
<p><a name="introduction"></a></p>
<div class="section" id="introduction">
<span id="introduction"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Laravel service container is a powerful tool for managing class dependencies and performing dependency injection. Dependency injection is a fancy phrase that essentially means this: class dependencies are &#8220;injected&#8221; into the class via the constructor or, in some cases, &#8220;setter&#8221; methods.</p>
<p>Let&#8217;s look at a simple example:</p>
<pre class="literal-block">
&lt;?php

namespace App\Jobs;

use App\User;
use Illuminate\Contracts\Mail\Mailer;
use Illuminate\Contracts\Bus\SelfHandling;

class PurchasePodcast implements SelfHandling
{
    /**
     * The mailer implementation.
     */
    protected $mailer;

    /**
     * Create a new instance.
     *
     * &#64;param  Mailer  $mailer
     * &#64;return void
     */
    public function __construct(Mailer $mailer)
    {
        $this-&gt;mailer = $mailer;
    }

    /**
     * Purchase a podcast.
     *
     * &#64;return void
     */
    public function handle()
    {
        //
    }
}
</pre>
<p>In this example, the <code class="docutils literal"><span class="pre">PurchasePodcast</span></code> job needs to send e-mails when a podcast is purchased. So, we will <strong>inject</strong> a service that is able to send e-mails. Since the service is injected, we are able to easily swap it out with another implementation. We are also able to easily &#8220;mock&#8221;, or create a dummy implementation of the mailer when testing our application.</p>
<p>A deep understanding of the Laravel service container is essential to building a powerful, large application, as well as for contributing to the Laravel core itself.</p>
<p><a name="binding"></a></p>
</div>
<div class="section" id="binding">
<span id="binding"></span><h2>Binding<a class="headerlink" href="#binding" title="Permalink to this headline">¶</a></h2>
<p>Almost all of your service container bindings will be registered within <a class="reference external" href="providers.html">service providers</a>, so all of these examples will demonstrate using the container in that context. However, there is no need to bind classes into the container if they do not depend on any interfaces. The container does not need to be instructed how to build these objects, since it can automatically resolve such &#8220;concrete&#8221; objects using PHP&#8217;s reflection services.</p>
<p>Within a service provider, you always have access to the container via the <code class="docutils literal"><span class="pre">$this-&gt;app</span></code> instance variable. We can register a binding using the <code class="docutils literal"><span class="pre">bind</span></code> method, passing the class or interface name that we wish to register along with a <code class="docutils literal"><span class="pre">Closure</span></code> that returns an instance of the class:</p>
<pre class="literal-block">
$this-&gt;app-&gt;bind('HelpSpot\API', function ($app) {
    return new HelpSpot\API($app['HttpClient']);
});
</pre>
<p>Notice that we receive the container itself as an argument to the resolver. We can then use the container to resolve sub-dependencies of the object we are building.</p>
<div class="section" id="binding-a-singleton">
<span id="binding-a-singleton"></span><h3>Binding A Singleton<a class="headerlink" href="#binding-a-singleton" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">singleton</span></code> method binds a class or interface into the container that should only be resolved one time, and then that same instance will be returned on subsequent calls into the container:</p>
<pre class="literal-block">
$this-&gt;app-&gt;singleton('FooBar', function ($app) {
    return new FooBar($app['SomethingElse']);
});
</pre>
</div>
<div class="section" id="binding-instances">
<span id="binding-instances"></span><h3>Binding Instances<a class="headerlink" href="#binding-instances" title="Permalink to this headline">¶</a></h3>
<p>You may also bind an existing object instance into the container using the <code class="docutils literal"><span class="pre">instance</span></code> method. The given instance will always be returned on subsequent calls into the container:</p>
<pre class="literal-block">
$fooBar = new FooBar(new SomethingElse);

$this-&gt;app-&gt;instance('FooBar', $fooBar);
</pre>
<p><a name="binding-interfaces-to-implementations"></a></p>
</div>
<div class="section" id="binding-interfaces-to-implementations">
<span id="binding-interfaces-to-implementations"></span><h3>Binding Interfaces To Implementations<a class="headerlink" href="#binding-interfaces-to-implementations" title="Permalink to this headline">¶</a></h3>
<p>A very powerful feature of the service container is its ability to bind an interface to a given implementation. For example, let&#8217;s assume we have an <code class="docutils literal"><span class="pre">EventPusher</span></code> interface and a <code class="docutils literal"><span class="pre">RedisEventPusher</span></code> implementation. Once we have coded our <code class="docutils literal"><span class="pre">RedisEventPusher</span></code> implementation of this interface, we can register it with the service container like so:</p>
<pre class="literal-block">
$this-&gt;app-&gt;bind('App\Contracts\EventPusher', 'App\Services\RedisEventPusher');
</pre>
<p>This tells the container that it should inject the <code class="docutils literal"><span class="pre">RedisEventPusher</span></code> when a class needs an implementation of <code class="docutils literal"><span class="pre">EventPusher</span></code>. Now we can type-hint the <code class="docutils literal"><span class="pre">EventPusher</span></code> interface in a constructor, or any other location where dependencies are injected by the service container:</p>
<pre class="literal-block">
use App\Contracts\EventPusher;

/**
 * Create a new class instance.
 *
 * &#64;param  EventPusher  $pusher
 * &#64;return void
 */
public function __construct(EventPusher $pusher)
{
    $this-&gt;pusher = $pusher;
}
</pre>
<p><a name="contextual-binding"></a></p>
</div>
<div class="section" id="contextual-binding">
<span id="contextual-binding"></span><h3>Contextual Binding<a class="headerlink" href="#contextual-binding" title="Permalink to this headline">¶</a></h3>
<p>Sometimes you may have two classes that utilize the same interface, but you wish to inject different implementations into each class. For example, when our system receives a new Order, we may want to send an event via <a class="reference external" href="http://www.pubnub.com/">PubNub</a> rather than Pusher. Laravel provides a simple, fluent interface for defining this behavior:</p>
<pre class="literal-block">
$this-&gt;app-&gt;when('App\Handlers\Commands\CreateOrderHandler')
          -&gt;needs('App\Contracts\EventPusher')
          -&gt;give('App\Services\PubNubEventPusher');
</pre>
<p>You may even pass a Closure to the <code class="docutils literal"><span class="pre">give</span></code> method:</p>
<pre class="literal-block">
$this-&gt;app-&gt;when('App\Handlers\Commands\CreateOrderHandler')
          -&gt;needs('App\Contracts\EventPusher')
          -&gt;give(function () {
                  // Resolve dependency...
              });
</pre>
<p><a name="tagging"></a></p>
</div>
<div class="section" id="tagging">
<span id="tagging"></span><h3>Tagging<a class="headerlink" href="#tagging" title="Permalink to this headline">¶</a></h3>
<p>Occasionally, you may need to resolve all of a certain &#8220;category&#8221; of binding. For example, perhaps you are building a report aggregator that receives an array of many different <code class="docutils literal"><span class="pre">Report</span></code> interface implementations. After registering the <code class="docutils literal"><span class="pre">Report</span></code> implementations, you can assign them a tag using the <code class="docutils literal"><span class="pre">tag</span></code> method:</p>
<pre class="literal-block">
$this-&gt;app-&gt;bind('SpeedReport', function () {
    //
});

$this-&gt;app-&gt;bind('MemoryReport', function () {
    //
});

$this-&gt;app-&gt;tag(['SpeedReport', 'MemoryReport'], 'reports');
</pre>
<p>Once the services have been tagged, you may easily resolve them all via the <code class="docutils literal"><span class="pre">tagged</span></code> method:</p>
<pre class="literal-block">
$this-&gt;app-&gt;bind('ReportAggregator', function ($app) {
    return new ReportAggregator($app-&gt;tagged('reports'));
});
</pre>
<p><a name="resolving"></a></p>
</div>
</div>
<div class="section" id="resolving">
<span id="resolving"></span><h2>Resolving<a class="headerlink" href="#resolving" title="Permalink to this headline">¶</a></h2>
<p>There are several ways to resolve something out of the container. First, you may use the <code class="docutils literal"><span class="pre">make</span></code> method, which accepts the name of the class or interface you wish to resolve:</p>
<pre class="literal-block">
$fooBar = $this-&gt;app-&gt;make('FooBar');
</pre>
<p>Secondly, you may access the container like an array, since it implements PHP&#8217;s <code class="docutils literal"><span class="pre">ArrayAccess</span></code> interface:</p>
<pre class="literal-block">
$fooBar = $this-&gt;app['FooBar'];
</pre>
<p>Lastly, but most importantly, you may simply &#8220;type-hint&#8221; the dependency in the constructor of a class that is resolved by the container, including <a class="reference external" href="controllers.html">controllers</a>, <a class="reference external" href="events.html">event listeners</a>, <a class="reference external" href="queues.html">queue jobs</a>, <a class="reference external" href="middleware.html">middleware</a>, and more. In practice, this is how most of your objects are resolved by the container.</p>
<p>The container will automatically inject dependencies for the classes it resolves. For example, you may type-hint a repository defined by your application in a controller&#8217;s constructor. The repository will automatically be resolved and injected into the class:</p>
<pre class="literal-block">
&lt;?php

namespace App\Http\Controllers;

use Illuminate\Routing\Controller;
use App\Users\Repository as UserRepository;

class UserController extends Controller
{
    /**
     * The user repository instance.
     */
    protected $users;

    /**
     * Create a new controller instance.
     *
     * &#64;param  UserRepository  $users
     * &#64;return void
     */
    public function __construct(UserRepository $users)
    {
        $this-&gt;users = $users;
    }

    /**
     * Show the user with the given ID.
     *
     * &#64;param  int  $id
     * &#64;return Response
     */
    public function show($id)
    {
        //
    }
}
</pre>
<p><a name="container-events"></a></p>
</div>
<div class="section" id="container-events">
<span id="container-events"></span><h2>Container Events<a class="headerlink" href="#container-events" title="Permalink to this headline">¶</a></h2>
<p>The service container fires an event each time it resolves an object. You may listen to this event using the <code class="docutils literal"><span class="pre">resolving</span></code> method:</p>
<pre class="literal-block">
$this-&gt;app-&gt;resolving(function ($object, $app) {
    // Called when container resolves object of any type...
});

$this-&gt;app-&gt;resolving(FooBar::class, function (FooBar $fooBar, $app) {
    // Called when container resolves objects of type &quot;FooBar&quot;...
});
</pre>
<p>As you can see, the object being resolved will be passed to the callback, allowing you to set any additional properties on the object before it is given to its consumer.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, The Weezqyd.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>